// Dados do jogo
const perguntas = [
    // N√≠vel 1 ‚Äì F√°cil (perguntas 1 a 5)
    {
        enunciado: "Quem foi o primeiro casal criado por Deus?",
        alternativas: [
            "Abra√£o e Sara",
            "Ad√£o e Eva",
            "Isaque e Rebeca",
            "Jac√≥ e Raquel"
        ],
        resposta: "Ad√£o e Eva",
        dificuldade: "F√°cil",
        valor: 1000
    },
    {
        enunciado: "Onde Ad√£o e Eva viveram antes de pecar?",
        alternativas: [
            "Torre de Babel",
            "Jardim do √âden",
            "Mar Vermelho",
            "Egito"
        ],
        resposta: "Jardim do √âden",
        dificuldade: "F√°cil",
        valor: 2000
    },
    {
        enunciado: "O amor √© citado como um dos frutos de...?",
        alternativas: [
            "Esp√≠rito",
            "Corpo",
            "Pecado",
            "Lei"
        ],
        resposta: "Esp√≠rito",
        dificuldade: "F√°cil",
        valor: 3000
    },
    {
        enunciado: "Qual destes √© um famoso vers√≠culo sobre o amor?",
        alternativas: [
            "G√™nesis 1:1",
            "Jo√£o 3:16",
            "1 Cor√≠ntios 13",
            "Salmo 23"
        ],
        resposta: "1 Cor√≠ntios 13",
        dificuldade: "F√°cil",
        valor: 4000
    },
    {
        enunciado: "Qual √© o maior mandamento segundo Jesus?",
        alternativas: [
            "N√£o matar√°s",
            "Amar√°s tua fam√≠lia",
            "Amar√°s o Senhor teu Deus",
            "Honrar pai e m√£e"
        ],
        resposta: "Amar√°s o Senhor teu Deus",
        dificuldade: "F√°cil",
        valor: 5000
    },

    // N√≠vel 2 ‚Äì M√©dio (perguntas 6 a 10)
    {
        enunciado: "Quem trabalhou 14 anos para casar com Raquel?",
        alternativas: [
            "Abra√£o",
            "Jac√≥",
            "Mois√©s",
            "Davi"
        ],
        resposta: "Jac√≥",
        dificuldade: "M√©dio",
        valor: 10000
    },
    {
        enunciado: "Qual casal orou por um filho e Deus respondeu com Samuel?",
        alternativas: [
            "Ad√£o e Eva",
            "Ana e Elcana",
            "Isaque e Rebeca",
            "Maria e Jos√©"
        ],
        resposta: "Ana e Elcana",
        dificuldade: "M√©dio",
        valor: 20000
    },
    {
        enunciado: "Em qual evangelho est√° escrito: 'Deus √© amor'?",
        alternativas: [
            "Mateus",
            "1 Jo√£o",
            "Marcos",
            "Lucas"
        ],
        resposta: "1 Jo√£o",
        dificuldade: "M√©dio",
        valor: 30000
    },
    {
        enunciado: "O que o amor n√£o faz, segundo 1 Cor√≠ntios 13?",
        alternativas: [
            "Protege",
            "Se vangloria",
            "Cr√™",
            "Espera"
        ],
        resposta: "Se vangloria",
        dificuldade: "M√©dio",
        valor: 40000
    },
    {
        enunciado: "Quem disse ‚ÄúPor onde fores, irei‚Äù?",
        alternativas: [
            "Ester",
            "Rute",
            "D√©bora",
            "Maria"
        ],
        resposta: "Rute",
        dificuldade: "M√©dio",
        valor: 50000
    },

    // N√≠vel 3 ‚Äì Dif√≠cil (perguntas 11 a 15)
    {
        enunciado: "Quantas vezes o amor √© mencionado em 1 Cor√≠ntios 13 (NVI)?",
        alternativas: [
            "7",
            "9",
            "10",
            "5"
        ],
        resposta: "9",
        dificuldade: "Dif√≠cil",
        valor: 100000
    },
    {
        enunciado: "Quem foi o esposo da profetisa D√©bora?",
        alternativas: [
            "Baraque",
            "Lapidote",
            "Nadabe",
            "Cor√°"
        ],
        resposta: "Lapidote",
        dificuldade: "Dif√≠cil",
        valor: 200000
    },
    {
        enunciado: "Qual o nome da esposa de Abra√£o?",
        alternativas: [
            "Raquel",
            "Rebeca",
            "Sara",
            "Ana"
        ],
        resposta: "Sara",
        dificuldade: "Dif√≠cil",
        valor: 300000
    },
    {
        enunciado: "Qual foi o sinal que Deus deu a Isaque para encontrar Rebeca?",
        alternativas: [
            "A mulher que oferecesse √°gua a ele e aos camelos",
            "A que tivesse roupas brancas",
            "A que viesse com perfume",
            "A que estivesse sozinha no po√ßo"
        ],
        resposta: "A mulher que oferecesse √°gua a ele e aos camelos",
        dificuldade: "Dif√≠cil",
        valor: 400000
    },
    {
        enunciado: "Complete: ‚ÄúO amor tudo sofre, tudo cr√™, tudo espera...‚Äù",
        alternativas: [
            "Tudo v√™",
            "Tudo suporta",
            "Tudo recebe",
            "Tudo prova"
        ],
        resposta: "Tudo suporta",
        dificuldade: "Dif√≠cil",
        valor: 500000
    }
];

// Valores dos pr√™mios
const premios = [
    { valor: "1 bombom", seguro: false },
    { valor: "2 bombons", seguro: false },
    { valor: "3 bombons", seguro: false },
    { valor: "1 mini barra de chocolate", seguro: false },
    { valor: "1 bombom + 1 mini barra", seguro: true },
    { valor: "2 mini barras de chocolate", seguro: false },
    { valor: "1 trufa", seguro: false },
    { valor: "1 trufa + 1 mini barra", seguro: false },
    { valor: "2 trufas", seguro: false },
    { valor: "1 pacote pequeno de M&Ms", seguro: true },
    { valor: "1 caixinha com 4 bombons sortidos", seguro: false },
    { valor: "1 barra m√©dia de chocolate", seguro: false },
    { valor: "1 cora√ß√£o de chocolate recheado", seguro: false },
    { valor: "1 pel√∫cia pequena + chocolate", seguro: false },
    { valor: "üéÅ 1 caixa de bombons especial!", seguro: true }
];

// Estado do jogo
let rodadaAtual = 0;
let perguntaAtual = null;
let respostaSelecionada = null;
let jogoAtivo = true;
let ajudasUsadas = {
    cartas: false,
    pular: false,
    plateia: false,
    eliminar: false
};

// Elementos do DOM
const elementos = {
    enunciado: document.getElementById('enunciado'),
    alternativas: document.querySelectorAll('.alternativa'),
    btnPerguntar: document.getElementById('btnPerguntar'),
    btnParar: document.getElementById('btnParar'),
    numeroRodada: document.getElementById('numeroRodada'),
    premioAtual: document.getElementById('premioAtual'),
    listaPremios: document.getElementById('listaPremios'),
    modal: document.getElementById('modal'),
    modalTitulo: document.getElementById('modalTitulo'),
    modalMensagem: document.getElementById('modalMensagem'),
    btnModalOk: document.getElementById('btnModalOk'),
    mensagem: document.getElementById('mensagem'),
    ajudas: {
        cartas: document.getElementById('ajuda-cartas'),
        pular: document.getElementById('ajuda-pular'),
        plateia: document.getElementById('ajuda-plateia'),
        eliminar: document.getElementById('ajuda-eliminar')
    }
};

// Fun√ß√µes do jogo
function iniciarJogo() {
    rodadaAtual = 0;
    jogoAtivo = true;
    respostaSelecionada = null;
    ajudasUsadas = {
        cartas: false,
        pular: false,
        plateia: false,
        eliminar: false
    };

    // Verificar localStorage
    const rodadaSalva = localStorage.getItem('rodada');
    if (rodadaSalva !== null) {
        rodadaAtual = parseInt(rodadaSalva);
        mostrarModal(
            'Bem-vindo de volta!',
            `Voc√™ estava na pergunta ${rodadaAtual + 1}. Vamos continuar?`,
            () => carregarPergunta()
        );
    } else {
        mostrarModal(
            'Bem-vindo ao Show do Javascript√£o!',
            'Responda corretamente √†s 15 perguntas e ganhe üéÅ 1 caixa de bombons especial !',
            () => carregarPergunta()
        );
    }

    criarListaPremios();
    atualizarInterface();
}

function criarListaPremios() {
    elementos.listaPremios.innerHTML = '';
    premios.forEach((premio, index) => {
        const div = document.createElement('div');
        div.className = 'premio-item';
        if (premio.seguro) div.classList.add('seguro');
        div.textContent = premio.valor;
        div.id = `premio-${index}`;
        elementos.listaPremios.appendChild(div);
    });
}

function carregarPergunta() {
    if (rodadaAtual >= perguntas.length) {
        vencerJogo();
        return;
    }

    perguntaAtual = perguntas[rodadaAtual];
    elementos.enunciado.textContent = perguntaAtual.enunciado;

    // Embaralhar alternativas
    const alternativasEmbaralhadas = [...perguntaAtual.alternativas].sort(() => Math.random() - 0.5);

    elementos.alternativas.forEach((btn, index) => {
        const texto = btn.querySelector('.texto-alternativa');
        texto.textContent = alternativasEmbaralhadas[index];
        btn.classList.remove('selecionada', 'correta', 'incorreta', 'eliminada');
        btn.disabled = false;
    });

    respostaSelecionada = null;
    elementos.btnPerguntar.disabled = true;
    atualizarInterface();

    // Salvar progresso
    localStorage.setItem('rodada', rodadaAtual);
}

function selecionarAlternativa(evento) {
    if (!jogoAtivo) return;

    // Remover sele√ß√£o anterior
    elementos.alternativas.forEach(alt => alt.classList.remove('selecionada'));

    // Adicionar sele√ß√£o atual
    const alternativa = evento.currentTarget;
    alternativa.classList.add('selecionada');
    respostaSelecionada = alternativa.querySelector('.texto-alternativa').textContent;

    elementos.btnPerguntar.disabled = false;
    elementos.mensagem.textContent = '';
}

function verificarResposta() {
    if (!respostaSelecionada || !jogoAtivo) return;

    jogoAtivo = false;
    elementos.btnPerguntar.disabled = true;

    const acertou = respostaSelecionada === perguntaAtual.resposta;

    // Mostrar resposta correta
    elementos.alternativas.forEach(alt => {
        const texto = alt.querySelector('.texto-alternativa').textContent;
        if (texto === perguntaAtual.resposta) {
            alt.classList.add('correta');
        } else if (alt.classList.contains('selecionada') && !acertou) {
            alt.classList.add('incorreta');
        }
    });

    setTimeout(() => {
        if (acertou) {
            acertarPergunta();
        } else {
            errarPergunta();
        }
    }, 2000);
}

function acertarPergunta() {
    const premio = premios[rodadaAtual].valor;
    rodadaAtual++;

    if (rodadaAtual >= perguntas.length) {
        vencerJogo();
    } else {
        mostrarModal(
            'Resposta Correta!',
            `Voc√™ acertou e garantiu ${premio}!`,
            () => {
                jogoAtivo = true;
                carregarPergunta();
            }
        );
    }
}

function errarPergunta() {
    const premioFinal = calcularPremioFinal();
    localStorage.removeItem('rodada');

    mostrarModal(
        'Resposta Incorreta!',
        `Que pena! A resposta correta era: ${perguntaAtual.resposta}\n\nVoc√™ ganhou ${premioFinal}`,
        () => reiniciarJogo()
    );
}

function pararJogo() {
    if (!jogoAtivo || rodadaAtual === 0) return;

    const premio = premios[rodadaAtual - 1].valor;
    localStorage.removeItem('rodada');

    mostrarModal(
        'Parou!',
        `Voc√™ decidiu parar e levou ${premio}!`,
        () => reiniciarJogo()
    );
}

function vencerJogo() {
    localStorage.removeItem('rodada');
    jogoAtivo = false;

    mostrarModal(
        'üéâ PARAB√âNS! üéâ',
        'Voc√™ acertou todas as perguntas e ganhou üéÅ 1 caixa de bombons especial!!',
        () => reiniciarJogo()
    );
}

function calcularPremioFinal() {
    // Retorna o valor do √∫ltimo pr√™mio seguro alcan√ßado
    let ultimoPremioSeguro = "nada";
    for (let i = 0; i < rodadaAtual; i++) {
        if (premios[i].seguro) {
            ultimoPremioSeguro = premios[i].valor;
        }
    }
    return ultimoPremioSeguro;
}

function reiniciarJogo() {
    rodadaAtual = 0;
    jogoAtivo = true;
    respostaSelecionada = null;
    carregarPergunta();
}

function atualizarInterface() {
    // Atualizar n√∫mero da rodada
    elementos.numeroRodada.textContent = rodadaAtual + 1;

    // Atualizar pr√™mio atual
    if (rodadaAtual < premios.length) {
        elementos.premioAtual.textContent = premios[rodadaAtual].valor;
    }

    // Atualizar lista de pr√™mios
    document.querySelectorAll('.premio-item').forEach((item, index) => {
        item.classList.remove('ativo');
        if (index === rodadaAtual) {
            item.classList.add('ativo');
        }
    });
}

function mostrarModal(titulo, mensagem, callback) {
    elementos.modalTitulo.textContent = titulo;
    elementos.modalMensagem.textContent = mensagem;
    elementos.modal.classList.remove('hidden');

    elementos.btnModalOk.onclick = () => {
        elementos.modal.classList.add('hidden');
        if (callback) callback();
    };
}

// Event Listeners
elementos.alternativas.forEach(alt => {
    alt.addEventListener('click', selecionarAlternativa);
});

elementos.btnPerguntar.addEventListener('click', verificarResposta);
elementos.btnParar.addEventListener('click', pararJogo);

// Iniciar o jogo
iniciarJogo();